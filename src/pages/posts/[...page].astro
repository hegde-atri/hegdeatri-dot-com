---
import Pagination from "../../components/Pagination.astro";
import PostList from "../../components/Posts/PostList.astro";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths({ paginate }) {
  const PAGE_SIZE = 8;

  let allPosts = await Astro.glob("../../../data/posts/**/*.md*");
  const posts = allPosts.filter((post) => !post.frontmatter.draft);
  let allSortedPosts = posts.sort(
    (a, b) => new Date(a.frontmatter.date).valueOf() - new Date(b.frontmatter.date).valueOf()
  ).reverse();

  return paginate(allSortedPosts, {
    pageSize: PAGE_SIZE,
  });
}

const { page } = Astro.props;
---
<Layout title="Posts">
  <h1>All posts</h1>
  <PostList posts={page.data} />
  <Pagination page={page} />
</Layout>


